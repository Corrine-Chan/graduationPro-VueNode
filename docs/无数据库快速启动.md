# 🚀 无需数据库快速启动指南

## 📝 说明

当前版本已配置为使用**内存数据库（Mock Database）**，无需安装 MySQL 即可运行！

---

## ⚡ 快速启动（3步）

### 第一步：安装后端依赖

```bash
cd server
npm install
```

### 第二步：启动后端服务

```bash
npm run dev
```

看到以下信息表示启动成功：

```
==================================================
🚀 服务器运行在 http://localhost:3000
📊 环境: development
🔗 API 地址: http://localhost:3000/api
💾 数据库模式: 内存数据库（Mock Database）
==================================================

📝 默认账号信息:
   管理员: admin123456 / 123456
   测试用户: test123456 / 123456

💡 提示: 当前使用内存数据库，无需安装 MySQL
==================================================
```

### 第三步：启动前端（新开一个终端）

```bash
# 回到项目根目录
cd ..

# 启动前端
npm run dev
```

---

## 🔑 登录测试

1. 浏览器访问：http://localhost:5173
2. 使用以下任一账号登录：

### 管理员账号

- 用户名：`admin123456`
- 密码：`123456`

### 测试用户账号

- 用户名：`test123456`
- 密码：`123456`

---

## ✨ 功能测试

### 1. 登录功能

- ✅ 输入账号密码
- ✅ 输入验证码（点击可刷新）
- ✅ 勾选"记住密码"
- ✅ 点击登录按钮

### 2. 注册功能

- ✅ 点击"注册"标签切换
- ✅ 输入用户名（6-11位）
- ✅ 输入密码（6位数字）
- ✅ 确认密码
- ✅ 输入部门名称
- ✅ 输入验证码
- ✅ 点击注册按钮

### 3. 其他功能

- ✅ 忘记密码提示
- ✅ 密码显示/隐藏
- ✅ 表单验证

---

## 📦 内存数据库说明

### 优点

- ✅ 无需安装 MySQL
- ✅ 快速启动测试
- ✅ 适合前后端联调
- ✅ 适合演示和开发

### 限制

- ⚠️ 数据保存在内存中
- ⚠️ 服务器重启后数据会丢失
- ⚠️ 只有预置的两个测试账号
- ⚠️ 新注册的用户重启后会消失

### 预置账号

系统预置了两个测试账号：

1. `admin123456` - 管理员账号
2. `test123456` - 普通用户账号

---

## 🔄 切换到真实数据库

当你准备好使用 MySQL 数据库时，按以下步骤操作：

### 1. 安装并启动 MySQL

### 2. 创建数据库

```bash
mysql -u root -p < server/database/schema.sql
```

### 3. 修改控制器

编辑 `server/src/controllers/authController.js`：

将第一行改为：

```javascript
import pool from "../config/database.js";
```

然后修改查询方法，使用真实数据库的 SQL 查询。

### 4. 修改 app.js

编辑 `server/src/app.js`：

将导入改为：

```javascript
import { testConnection } from "./config/database.js";
```

---

## 🐛 常见问题

### 1. 端口被占用

**错误**：`Error: listen EADDRINUSE: address already in use :::3000`

**解决**：

- 关闭占用 3000 端口的程序
- 或修改 `server/.env` 中的 `PORT=3001`

### 2. 前端无法连接后端

**检查**：

- 后端是否正常启动
- 前端 `.env.development` 中的 `VITE_API_URL` 是否为 `http://localhost:3000`
- 浏览器控制台是否有 CORS 错误

### 3. 登录失败

**检查**：

- 用户名是否正确（`admin123456` 或 `test123456`）
- 密码是否正确（`123456`）
- 验证码是否正确（区分大小写）
- 浏览器控制台是否有错误信息

### 4. 验证码错误

- 验证码不区分大小写
- 点击验证码可以刷新
- 如果一直错误，检查浏览器控制台

---

## 📊 API 接口测试

你也可以使用 Postman 或 curl 测试 API：

### 登录接口

```bash
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d "{\"username\":\"admin123456\",\"password\":\"123456\"}"
```

### 注册接口

```bash
curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d "{\"username\":\"newuser123\",\"password\":\"123456\",\"department\":\"测试部\"}"
```

### 健康检查

```bash
curl http://localhost:3000/api/health
```

---

## 💡 开发建议

1. **先使用内存数据库**进行前后端联调
2. **功能开发完成后**再切换到 MySQL
3. **保留内存数据库代码**，方便快速测试
4. **生产环境**必须使用真实数据库

---

## 🎉 开始使用

现在你可以：

1. 启动后端：`cd server && npm run dev`
2. 启动前端：`npm run dev`
3. 访问：http://localhost:5173
4. 登录：`admin123456` / `123456`

祝开发顺利！
