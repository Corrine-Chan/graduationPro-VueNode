# 充电桩管理模块

## 📊 模块概述

充电桩管理模块用于监控和管理各充电站的充电桩状态，包括充电桩列表展示、状态筛选、使用记录查看等功能。

## ✨ 功能特性

### 1. 充电站选择

- 下拉选择框选择充电站
- 支持模糊搜索充电站名称
- 自动加载该站点的所有充电桩

### 2. 状态筛选

- 全部状态统计
- 按状态筛选：空闲中、充电中、连接中、排队中、已预约、故障/离线
- 实时显示各状态的充电桩数量

### 3. 充电桩展示

- 卡片式展示充电桩信息
- 显示充电桩ID、电压、电流、功率、温度
- 状态图标可视化（不同状态不同图标）
- 充电进度百分比显示

### 4. 使用记录

- 点击"使用记录"按钮查看
- 时间线形式展示充电记录
- 显示充电度数和消费金额

### 5. 维修记录

- 维修记录按钮（待开发）

## 🔌 API接口

### 获取充电桩列表

**接口地址**: `POST /api/station/pile/list`

**请求参数**: 无

**响应数据**:

```json
{
  "code": 200,
  "success": true,
  "data": [
    {
      "id": "VXZ10001",
      "name": "北京西单充电站",
      "list": [
        {
          "id": "CD1001",
          "voltage": "314v",
          "current": "212.2A",
          "power": "21KW",
          "tem": "32°c",
          "status": 1,
          "percent": null,
          "record": [
            {
              "time": "18:08:33",
              "msg": "充电100度，消费100元"
            }
          ]
        }
      ]
    }
  ]
}
```

## 🗄️ 数据库表

### charging_pile（充电桩详情表）

| 字段名         | 类型         | 说明                                                         |
| -------------- | ------------ | ------------------------------------------------------------ |
| pile_id        | VARCHAR(50)  | 充电桩ID                                                     |
| station_id     | VARCHAR(50)  | 所属充电站ID                                                 |
| station_name   | VARCHAR(200) | 所属充电站名称                                               |
| voltage        | VARCHAR(20)  | 电压                                                         |
| current        | VARCHAR(20)  | 电流                                                         |
| power          | VARCHAR(20)  | 功率                                                         |
| temperature    | VARCHAR(20)  | 温度                                                         |
| status         | TINYINT      | 状态: 1-空闲 2-充电中 3-连接中 4-排队中 5-被预约 6-故障/离线 |
| charge_percent | VARCHAR(10)  | 充电进度百分比                                               |

### pile_usage_record（充电桩使用记录表）

| 字段名          | 类型          | 说明     |
| --------------- | ------------- | -------- |
| pile_id         | VARCHAR(50)   | 充电桩ID |
| record_time     | TIME          | 记录时间 |
| energy_consumed | DECIMAL(10,2) | 充电度数 |
| amount          | DECIMAL(10,2) | 消费金额 |
| record_date     | DATE          | 记录日期 |

## 📝 状态说明

| 状态值 | 状态名称  | 图标     | 说明                 |
| ------ | --------- | -------- | -------------------- |
| 1      | 空闲中    | 绿色图标 | 充电桩可用，等待充电 |
| 2      | 充电中    | 蓝色图标 | 正在充电，显示进度   |
| 3      | 连接中    | 黄色图标 | 正在连接设备         |
| 4      | 排队中    | 橙色图标 | 有车辆排队等待       |
| 5      | 已预约    | 紫色图标 | 已被用户预约         |
| 6      | 故障/离线 | 红色图标 | 设备故障或离线       |

## 📊 数据说明

### 示例数据

系统已预置3个充电站的充电桩数据：

- **北京西单充电站**：19个充电桩
- **上海陆家嘴充电站**：14个充电桩
- **广州花城广场充电站**：14个充电桩

### 使用记录

- CD1001充电桩有6条使用记录
- 记录包含时间、充电度数、消费金额
- 按时间倒序排列，最多显示10条

## 🎯 使用方法

### 访问页面

1. 登录系统
2. 点击左侧菜单：**充电站管理** > **充电桩管理**

### 选择充电站

1. 点击顶部下拉选择框
2. 选择要查看的充电站
3. 自动加载该站点的所有充电桩

### 筛选充电桩

1. 点击状态按钮（全部/空闲中/充电中等）
2. 表格只显示对应状态的充电桩
3. 按钮上显示该状态的充电桩数量

### 查看使用记录

1. 找到要查看的充电桩卡片
2. 点击"使用记录"按钮
3. 弹出框显示该充电桩的使用记录

## 🔧 技术实现

### 前端技术

- Vue 3 + TypeScript
- Element Plus UI组件库
- 响应式布局
- 状态管理

### 后端技术

- Node.js + Express
- MySQL数据库
- JWT认证
- 多表关联查询

## 📈 数据流程

```
前端页面 (Fault.vue)
    ↓
API调用 (chargingstation.ts)
    ↓
后端路由 (station.js)
    ↓
控制器方法 (stationController.js)
    ↓
数据库查询 (charging_pile + pile_usage_record)
    ↓
返回数据
    ↓
前端渲染展示
```

## 🚀 初始化步骤

### 方式一：使用批处理脚本

```bash
双击运行：初始化充电桩数据.bat
```

### 方式二：使用命令行

```bash
mysql -u root -p charging_station < database\init_pile_data.sql
```

### 方式三：在MySQL客户端中执行

```sql
USE charging_station;
SOURCE database/init_pile_data.sql;
```

## 🐛 已知问题

无

## 📅 更新日志

### 2026-02-02

- ✅ 完成后端API接口开发
- ✅ 完成数据库表设计
- ✅ 完成前后端联调
- ✅ 插入3个充电站共47个充电桩的测试数据
- ✅ 插入CD1001充电桩的6条使用记录

---

**模块状态**: ✅ 已完成  
**最后更新**: 2026-02-02
