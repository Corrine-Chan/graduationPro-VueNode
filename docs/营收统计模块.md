# 营收统计模块

## 📊 模块概述

营收统计模块用于展示和管理充电站的营收数据，包括统计卡片、趋势图表和明细列表。

## ✨ 功能特性

### 1. 统计卡片展示

- 6个统计卡片展示今日各项收入指标
- 数字千分位格式化显示
- 增长率百分比显示

### 2. 营收趋势图表

- 月度销售额柱状图（绿色）
- 访问量折线图（蓝色）
- 双Y轴展示不同维度数据
- 交互式tooltip提示

### 3. 营收明细表格

- 32个充电站的详细营收数据
- 支持按站点名称模糊搜索
- 分页显示（10/20/30/40条/页）
- 增长率标签（正数绿色，负数红色）
- 单日总收入排序功能

## 🔌 API接口

### 1. 获取营收统计列表

**接口地址**: `POST /api/station/revenue/list`

**请求参数**:

```json
{
  "page": 1,
  "pageSize": 10,
  "name": ""
}
```

**响应数据**:

```json
{
  "code": 200,
  "success": true,
  "data": {
    "list": [...],
    "total": 32
  }
}
```

### 2. 获取营收图表数据

**接口地址**: `GET /api/station/revenue/chart`

**响应数据**:

```json
{
  "code": 200,
  "success": true,
  "data": {
    "list": [
      {
        "name": "销售",
        "data": [60, 40, 120, ...]
      },
      {
        "name": "访问量",
        "data": [600, 400, 600, ...]
      }
    ]
  }
}
```

## 🗄️ 数据库表

### station_revenue（充电站营收统计表）

| 字段名              | 类型          | 说明             |
| ------------------- | ------------- | ---------------- |
| station_id          | VARCHAR(50)   | 站点ID           |
| station_name        | VARCHAR(200)  | 站点名称         |
| city                | VARCHAR(50)   | 所属城市         |
| pile_count          | INT           | 充电桩总数量     |
| electricity_fee     | DECIMAL(10,2) | 电费营收(元)     |
| parking_fee         | DECIMAL(10,2) | 停车费营收(元)   |
| service_fee         | DECIMAL(10,2) | 服务费营收(元)   |
| member_recharge     | DECIMAL(10,2) | 会员储值金(元)   |
| daily_total         | DECIMAL(10,2) | 单日总收入(元)   |
| monthly_total       | DECIMAL(10,2) | 月度总收入(万元) |
| daily_growth_rate   | DECIMAL(5,2)  | 日增长率(%)      |
| monthly_growth_rate | DECIMAL(5,2)  | 月增长率(%)      |
| stat_date           | DATE          | 统计日期         |

### revenue_chart（营收图表数据表）

| 字段名       | 类型          | 说明         |
| ------------ | ------------- | ------------ |
| month        | TINYINT       | 月份(1-12)   |
| sales_amount | DECIMAL(10,2) | 销售额(万元) |
| visit_count  | INT           | 访问量       |
| stat_year    | INT           | 统计年份     |

## 📝 数据说明

### 示例数据

系统已预置32个充电站的营收数据，包括：

- 北京西单充电站
- 上海陆家嘴充电站
- 广州花城广场充电站
- 深圳大梅沙充电站
- ... 等32个站点

### 月度总收入说明

月度总收入是**独立统计的累计值**，代表该充电站本月实际的总营收，不是简单的单日收入×30天。

**业务含义**:

- 反映了真实的月度经营情况
- 考虑了工作日、周末、节假日的收入波动
- 包含了整个月的实际累计数据

## 🎯 使用方法

### 访问页面

1. 登录系统
2. 点击左侧菜单：**充电站管理** > **营收统计**

### 查看统计数据

- 顶部6个卡片展示今日各项收入
- 中间图表展示月度营收趋势
- 底部表格展示各站点详细数据

### 搜索功能

1. 在搜索框输入站点名称（支持模糊搜索）
2. 点击搜索按钮
3. 表格显示匹配的结果

### 分页功能

1. 点击页码切换不同页
2. 选择每页显示条数（10/20/30/40）
3. 使用跳转功能快速定位

## 🔧 技术实现

### 前端技术

- Vue 3 + TypeScript
- Element Plus UI组件库
- ECharts图表库
- Axios HTTP客户端

### 后端技术

- Node.js + Express
- MySQL数据库
- JWT认证
- mysql2连接池

## 📈 数据流程

```
前端页面 (Revenue.vue)
    ↓
API调用 (chargingstation.ts)
    ↓
后端路由 (station.js)
    ↓
控制器方法 (stationController.js)
    ↓
数据库查询 (station_revenue表)
    ↓
返回数据
    ↓
前端渲染展示
```

## 🐛 已知问题

无

## 📅 更新日志

### 2026-02-02

- ✅ 完成后端API接口开发
- ✅ 完成数据库表设计
- ✅ 完成前后端联调
- ✅ 修复单日总收入显示异常问题
- ✅ 插入32条测试数据

---

**模块状态**: ✅ 已完成  
**最后更新**: 2026-02-02
